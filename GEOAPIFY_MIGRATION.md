# Миграция с 2GIS на Geoapify

## Почему?
- 2GIS: $39,500/год - очень дорого
- Geoapify: **БЕСПЛАТНО** до 3,000 запросов/день (90,000/месяц)
- С нашим кэшированием: ~500-1000 запросов/день реально

## Что изменилось?
✅ **HomeScreen.js** - БЕЗ ИЗМЕНЕНИЙ! Вся ваша логика сохранена
✅ **Логика маршрутов** - работает как раньше
✅ **Кэширование** - работает как раньше
✅ **Scoring система** - сохранена в коде

❌ **Только backend** (`geocoding.py`) - заменён API провайдер

## Что нужно сделать:

### 1. Зарегистрироваться на Geoapify (2 минуты)
1. Идите на https://www.geoapify.com/
2. Нажмите "Sign Up" (бесплатно)
3. Подтвердите email
4. Войдите в Dashboard
5. Скопируйте "API Key"

### 2. Добавить ключ в .env
Откройте файл: `server_py/.env`

Найдите строку:
```
GEOAPIFY_API_KEY=""
```

Замените на:
```
GEOAPIFY_API_KEY="ваш_ключ_сюда"
```

### 3. Перезапустить backend
```powershell
cd server_py
taskkill /F /IM python.exe 2>$null
.\.venv\Scripts\python.exe run_noinit.py
```

### 4. Проверить работу
- Откройте приложение
- Попробуйте ввести адрес (например "Луч")
- Проверьте что подсказки работают
- Кликните на карту - проверьте reverse geocoding

## Что сохранилось:
- ✅ Все маршруты строятся автоматически
- ✅ Точка A фиксируется после первого маршрута
- ✅ Кэш работает (suggest + geocode + reverse)
- ✅ Debounce 500ms и минимум 3 символа
- ✅ "с. Луч" отображается правильно (если Geoapify вернёт village)

## Если не работает:
1. Проверьте что ключ добавлен в .env (без кавычек или с кавычками)
2. Проверьте логи backend - должны быть "[DEBUG SUGGEST] Geoapify response..."
3. Напишите мне - я помогу!

## Ограничения бесплатного плана:
- 3,000 запросов/день
- С кэшем это ~5-10 активных пользователей/день
- Если нужно больше: $49/месяц за 100k запросов ($588/год)
